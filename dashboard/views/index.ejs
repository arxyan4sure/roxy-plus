<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roxy+ Dashboard</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="icon" href="/favicon.ico">
    <style>
        .dashboard-container {
            position: relative;
        }

        /* Ensure relative context */

        .logout-btn {
            position: absolute;
            top: 25px;
            right: 25px;
            color: #e74c3c;
            text-decoration: none;
            font-weight: bold;
            background: rgba(231, 76, 60, 0.1);
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid rgba(231, 76, 60, 0.3);
            transition: 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
            z-index: 10;
            font-size: 0.9rem;
        }

        .logout-btn:hover {
            background: #e74c3c;
            color: #fff;
        }

        @media (max-width: 768px) {
            .logout-btn {
                top: 15px;
                right: 15px;
                padding: 6px 12px;
                font-size: 0.8rem;
            }

            .logout-text {
                display: none;
            }

            /* Show icon only on small screens? Optional. */
        }
    </style>
</head>

<body>

    <div class="dashboard-container">
        <!-- Logout Button Inside Container -->
        <a href="/logout" class="logout-btn">
            <i class="fas fa-sign-out-alt"></i> <span class="logout-text">Logout</span>
        </a>

        <div class="profile-section">
            <% let strokeClass='stroke-offline' ; if(status==='online' ) strokeClass='stroke-online' ;
                if(status==='idle' ) strokeClass='stroke-idle' ; if(status==='dnd' ) strokeClass='stroke-dnd' ; %>

                <div class="avatar-wrapper <%= strokeClass %>">
                    <img src="<%= user.displayAvatarURL({ format: 'png', dynamic: true, size: 512 }) %>" alt="Avatar"
                        class="avatar">
                </div>
        </div>

        <h1 class="username">
            <%= user.username %>
                <span class="discriminator">#<%= user.discriminator %></span>
        </h1>

        <div class="uptime-section">
            <div class="title">System Uptime</div>
            <div class="uptime-badge">
                Loading...
            </div>
        </div>

        <hr class="divider">

        <form action="/update-status" method="POST" class="settings-form">
            <div class="form-group">
                <label>Status Mode</label>
                <div class="status-options">
                    <label class="radio-label">
                        <input type="radio" name="status" value="online" <%=status==='online' ? 'checked' : '' %>>
                        <span class="radio-btn online">Online</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="status" value="idle" <%=status==='idle' ? 'checked' : '' %>>
                        <span class="radio-btn idle">Idle</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="status" value="dnd" <%=status==='dnd' ? 'checked' : '' %>>
                        <span class="radio-btn dnd">DND</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="status" value="invisible" <%=status==='invisible' ? 'checked' : '' %>>
                        <span class="radio-btn offline">Invisible</span>
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label>Custom Message</label>
                <input type="text" name="custom_status" class="input-field" placeholder="Playing with code..."
                    value="<%= currentActivity %>">
            </div>

            <div class="form-group">
                <label>Emoji (Nitro Support)</label>
                <input type="text" name="emoji" class="input-field" placeholder="ðŸ• or <:name:id>"
                    value="<%= currentEmoji %>">
                <small class="hint">Paste emoji or use ID format for custom ones</small>
            </div>

            <button type="submit" class="save-btn">Update Status</button>
        </form>

    </div>

    <script>
        let uptimeSeconds = <%= uptimeSeconds %>;

        function updateUptime() {
            uptimeSeconds++;
            let diff = uptimeSeconds;

            let days = Math.floor(diff / 86400);
            diff %= 86400;
            let hours = Math.floor(diff / 3600);
            diff %= 3600;
            let minutes = Math.floor(diff / 60);
            let seconds = Math.floor(diff % 60);

            const uptimeStr = `${days}d ${hours}h ${minutes}m ${seconds}s`;
            document.querySelector('.uptime-badge').innerText = uptimeStr;
        }

        setInterval(updateUptime, 1000);
        updateUptime(); // Initial call
    </script>
    <%- include('partials/super_button') %>
</body>

</html>